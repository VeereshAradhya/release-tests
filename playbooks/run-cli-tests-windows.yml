---
- name: Run release test on RHEL vm
  hosts: test-host
  tasks:
    - name: clone the release tests repository
      win_shell: |
        cd C:\Users\Admin\workspace
        git config --global http.sslVerify "false"
        git clone https://github.com/VeereshAradhya/release-tests.git
        cd release-tests
        git checkout poc-demo
        oc login -u kubeadmin -p {{ lookup('env','OC_PASSWORD') }} {{ lookup('env','OC_SERVER') }} --insecure-skip-tls-verify=true
        gauge run --env "test" --log-level=debug --verbose specs/cli/pipelines-e2e.spec
      register: output
      ignore_errors: True
    - debug:
        msg: "{{ output.stdout_lines | to_nice_yaml}}"
